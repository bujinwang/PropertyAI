# Test Design: Story 23.2 - Intelligent Alert Grouping

Date: 2025-09-18
Story: 23.2 - Intelligent Alert Grouping

## Test Strategy Overview

Unit and integration tests for grouping logic, filters, UI interactions. Target 100% coverage for new code, regression for existing alerts.

### P0 Scenarios (Must Have)
1. **Grouping Logic (AC1)**
   - Verify AlertGroupingService.groupAlerts aggregates by type/priority, returns groups with counts/alerts.
   - Test: Jest unit for groupAlerts with mock alerts (by type/priority); integration with Sequelize (mock DB, assert query/group by).
   - Edge: Empty alerts (return []), filters (type/priority/date, assert filtered groups).

2. **UI Rendering (AC2)**
   - Verify AlertGroupView renders groups with badges/colors (MUI Chip), collapse/expand (state toggle).
   - Test: Jest unit for rendering (snapshot with expanded false/true), filter change (update groups).
   - E2E: Cypress visit dashboard, assert groups visible, click expand (assert alerts list), apply filter (assert filtered).

3. **Integration with Existing (AC3)**
   - Verify ChurnRiskAlerts/MaintenanceAlerts use grouping (call service, pass to View).
   - Test: Jest integration for component with mock service (assert View receives groups); E2E full flow (load alerts, group display).

4. **Performance for 1000+ Alerts (AC4)**
   - Verify server-side pagination (offset/limit), query <2s.
   - Test: Mock large data (1000 alerts), measure time (console.time); integration DB with index, assert count <2s.

### P1 Scenarios (High Priority)
1. **Filters and Pagination (AC1,4)**
   - Test: Unit for client-side fallback (applyClientSideFilters); integration pagination (limit 50, assert page).

2. **No Regressions (AC10)**
   - Run Epic 21 alert tests, assert pass.

### P2 Scenarios (Medium Priority)
1. **Visual Indicators (AC2)**
   - Jest for Chip color by priority.

## Test Types and Coverage
- **Unit Tests**: 70% - Service grouping/filters, View rendering/collapse.
- **Integration Tests**: 30% - DB queries, component with service.
- **E2E Tests**: 100% - Cypress for UI flow/filtering.
- **Performance Tests**: Console.time for query, mock 1000 items.

## Test Data Requirements
- Mock alerts (1000+ for perf, various type/priority).
- DB fixtures for integration (Sequelize sync).

## Risks and Mitigations
- Risk: DB query slow without indexes. Mitigation: Migration indexes verified in test.
- Risk: Client-side grouping slow for large sets. Mitigation: Server fallback tested.

Coverage Target: 100% for new code.